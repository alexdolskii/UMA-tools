2025-08-06 16:00:49,321 - INFO - === 3D Nuclei Analysis Pipeline ===
2025-08-06 16:00:49,322 - INFO - Start: 2025-08-06 16:00:49
2025-08-06 16:00:49,324 - INFO - Execution mode: full
2025-08-06 16:00:49,585 - INFO - Loaded custom model: /Users/aleksandrdolskii/Desktop/Models for FIA/stardist-512-v3-2
2025-08-06 16:00:49,586 - INFO - Running Fiji processing in main process for /Users/aleksandrdolskii/Desktop/ImageJ projects/files_to_tif/nd2/INPUT
2025-08-06 16:00:49,586 - INFO - Starting Fiji processing for /Users/aleksandrdolskii/Desktop/ImageJ projects/files_to_tif/nd2/INPUT
2025-08-06 16:00:59,398 - INFO - Saved /Users/aleksandrdolskii/Desktop/ImageJ projects/files_to_tif/nd2/INPUT/processed/BK_Near_Poly_Lysine_CS3_002_nuclei.tif
2025-08-06 16:01:01,054 - INFO - Saved /Users/aleksandrdolskii/Desktop/ImageJ projects/files_to_tif/nd2/INPUT/processed/BK_Near_Poly_Lysine_CS3_003_nuclei.tif
2025-08-06 16:03:17,300 - INFO - === 3D Nuclei Analysis Pipeline ===
2025-08-06 16:03:17,300 - INFO - Start: 2025-08-06 16:03:17
2025-08-06 16:03:25,972 - INFO - Execution mode: stardist
2025-08-06 16:03:26,239 - INFO - Loaded custom model: /Users/aleksandrdolskii/Desktop/Models for FIA/stardist-512-v3-2
2025-08-06 16:03:26,239 - INFO - Starting segmentation with n_tiles: [2, 4, 4]
2025-08-06 16:03:26,239 - INFO - Starting segmentation with n_tiles: (2, 4, 4)
2025-08-06 16:03:26,240 - INFO - Processing BK_Near_Poly_Lysine_CS3_002_nuclei.tif
2025-08-06 16:03:26,309 - INFO - Image shape: (30, 512, 512)
2025-08-06 16:03:39,366 - INFO - Saved mask: /Users/aleksandrdolskii/Desktop/ImageJ projects/files_to_tif/nd2/INPUT/masks/BK_Near_Poly_Lysine_CS3_002_nuclei_mask.tif with 24 nuclei
2025-08-06 16:03:39,959 - INFO - Processing BK_Near_Poly_Lysine_CS3_003_nuclei.tif
2025-08-06 16:03:40,023 - INFO - Image shape: (34, 512, 512)
2025-08-06 16:03:53,731 - INFO - Saved mask: /Users/aleksandrdolskii/Desktop/ImageJ projects/files_to_tif/nd2/INPUT/masks/BK_Near_Poly_Lysine_CS3_003_nuclei_mask.tif with 15 nuclei
2025-08-06 16:03:56,268 - INFO - Collected data for 2 images
2025-08-06 16:03:56,270 - INFO - Saved final summary to /Users/aleksandrdolskii/Desktop/ImageJ projects/files_to_tif/nd2/INPUT/clustering/clustering_summary.csv
2025-08-06 16:03:56,270 - INFO - === Processing Complete ===
2025-08-06 16:03:56,270 - INFO - End: 2025-08-06 16:03:56
2025-08-19 16:30:47,917 - INFO - === 3D Nuclei Analysis Pipeline ===
2025-08-19 16:30:47,918 - INFO - Start: 2025-08-19 16:30:47
2025-08-19 16:30:47,922 - INFO - Execution mode: full
2025-08-19 16:30:48,182 - INFO - Loaded custom model: /Users/aleksandrdolskii/Desktop/Models for FIA/stardist-512-v3-2
2025-08-19 16:30:48,184 - INFO - Running Fiji processing in main process for /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test
2025-08-19 16:30:48,184 - INFO - Starting Fiji processing for /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test
2025-08-19 16:30:57,646 - INFO - Saved /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test/processed/BNfarP1+17i_FN647_pSMADRR_DAPI_A8301_Cover1_1003_40_nuclei.tif
2025-08-19 16:30:59,662 - INFO - Saved /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test/processed/BNfarP1+17i_FN647_pSMADRR_DAPI_DMSO_Cover1_1005_40_nuclei.tif
2025-08-19 16:31:29,462 - INFO - === 3D Nuclei Analysis Pipeline ===
2025-08-19 16:31:29,462 - INFO - Start: 2025-08-19 16:31:29
2025-08-19 16:31:34,982 - INFO - Execution mode: stardist
2025-08-19 16:31:35,212 - INFO - Loaded custom model: /Users/aleksandrdolskii/Desktop/Models for FIA/stardist-512-v3-2
2025-08-19 16:31:35,212 - INFO - Starting segmentation with n_tiles: [2, 4, 4]
2025-08-19 16:31:35,212 - INFO - Starting segmentation with n_tiles: (2, 4, 4)
2025-08-19 16:31:35,213 - INFO - Processing BNfarP1+17i_FN647_pSMADRR_DAPI_A8301_Cover1_1003_40_nuclei.tif
2025-08-19 16:31:35,277 - INFO - Image shape: (31, 512, 512)
2025-08-19 16:31:47,159 - INFO - Saved mask: /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test/masks/BNfarP1+17i_FN647_pSMADRR_DAPI_A8301_Cover1_1003_40_nuclei_mask.tif with 7 nuclei
2025-08-19 16:31:47,749 - INFO - Processing BNfarP1+17i_FN647_pSMADRR_DAPI_DMSO_Cover1_1005_40_nuclei.tif
2025-08-19 16:31:47,814 - INFO - Image shape: (39, 512, 512)
2025-08-19 16:32:01,084 - INFO - Saved mask: /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test/masks/BNfarP1+17i_FN647_pSMADRR_DAPI_DMSO_Cover1_1005_40_nuclei_mask.tif with 5 nuclei
2025-08-19 16:32:03,120 - INFO - Collected data for 2 images
2025-08-19 16:32:03,126 - INFO - Saved final summary to /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test/clustering/clustering_summary.csv
2025-08-19 16:32:03,127 - INFO - === Processing Complete ===
2025-08-19 16:32:03,127 - INFO - End: 2025-08-19 16:32:03
2025-08-19 16:33:10,157 - INFO - === 3D Nuclei Analysis Pipeline ===
2025-08-19 16:33:10,157 - INFO - Start: 2025-08-19 16:33:10
2025-08-19 16:33:11,463 - INFO - Execution mode: stardist
2025-08-19 16:33:11,748 - INFO - Using built-in 3D_demo model
2025-08-19 16:33:11,748 - INFO - Starting segmentation with n_tiles: [2, 4, 4]
2025-08-19 16:33:11,749 - INFO - Starting segmentation with n_tiles: (2, 4, 4)
2025-08-19 16:33:11,749 - INFO - Processing BNfarP1+17i_FN647_pSMADRR_DAPI_A8301_Cover1_1003_40_nuclei.tif
2025-08-19 16:33:11,801 - INFO - Image shape: (31, 512, 512)
2025-08-19 16:33:54,673 - INFO - Saved mask: /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test/masks/BNfarP1+17i_FN647_pSMADRR_DAPI_A8301_Cover1_1003_40_nuclei_mask.tif with 65 nuclei
2025-08-19 16:33:55,017 - INFO - Processing BNfarP1+17i_FN647_pSMADRR_DAPI_DMSO_Cover1_1005_40_nuclei.tif
2025-08-19 16:33:55,086 - INFO - Image shape: (39, 512, 512)
2025-08-19 16:35:26,264 - INFO - Saved mask: /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test/masks/BNfarP1+17i_FN647_pSMADRR_DAPI_DMSO_Cover1_1005_40_nuclei_mask.tif with 158 nuclei
2025-08-19 16:35:33,496 - INFO - Collected data for 2 images
2025-08-19 16:35:33,498 - INFO - Saved final summary to /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test/clustering/clustering_summary.csv
2025-08-19 16:35:33,498 - INFO - === Processing Complete ===
2025-08-19 16:35:33,498 - INFO - End: 2025-08-19 16:35:33
2025-08-19 16:37:49,155 - INFO - === 3D Nuclei Analysis Pipeline ===
2025-08-19 16:37:49,155 - INFO - Start: 2025-08-19 16:37:49
2025-08-19 16:37:49,156 - INFO - Execution mode: full
2025-08-19 16:37:49,368 - INFO - Loaded custom model: /Users/aleksandrdolskii/Desktop/Models for FIA/stardist-512-v3-2
2025-08-19 16:37:49,369 - INFO - Running Fiji processing in main process for /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test
2025-08-19 16:37:49,369 - INFO - Starting Fiji processing for /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test
2025-08-19 16:37:54,598 - INFO - Saved /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test/processed/BNfarP1+17i_FN647_pSMADRR_DAPI_A8301_Cover1_1001_40_nuclei.tif
2025-08-19 16:37:56,166 - INFO - Saved /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test/processed/BNfarP1+17i_FN647_pSMADRR_DAPI_A8301_Cover1_1002_40_nuclei.tif
2025-08-19 16:37:57,791 - INFO - Saved /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test/processed/BNfarP1+17i_FN647_pSMADRR_DAPI_A8301_Cover1_1003_40_nuclei.tif
2025-08-19 16:37:59,268 - INFO - Saved /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test/processed/BNfarP1+17i_FN647_pSMADRR_DAPI_A8301_Cover2_1001_40_nuclei.tif
2025-08-19 16:38:00,953 - INFO - Saved /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test/processed/BNfarP1+17i_FN647_pSMADRR_DAPI_DMSO_Cover1_1004_40_nuclei.tif
2025-08-19 16:38:02,882 - INFO - Saved /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test/processed/BNfarP1+17i_FN647_pSMADRR_DAPI_DMSO_Cover1_1005_40_nuclei.tif
2025-08-19 16:38:04,665 - INFO - Saved /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test/processed/BNfarP1+17i_FN647_pSMADRR_DAPI_DMSO_Cover1_1006_40_nuclei.tif
2025-08-19 16:38:40,369 - INFO - === 3D Nuclei Analysis Pipeline ===
2025-08-19 16:38:40,369 - INFO - Start: 2025-08-19 16:38:40
2025-08-19 16:38:41,896 - INFO - Execution mode: stardist
2025-08-19 16:38:42,125 - INFO - Loaded custom model: /Users/aleksandrdolskii/Desktop/Models for FIA/stardist-512-v3-2
2025-08-19 16:38:42,125 - INFO - Starting segmentation with n_tiles: [2, 4, 4]
2025-08-19 16:38:42,126 - INFO - Starting segmentation with n_tiles: (2, 4, 4)
2025-08-19 16:38:42,126 - INFO - Processing BNfarP1+17i_FN647_pSMADRR_DAPI_A8301_Cover1_1001_40_nuclei.tif
2025-08-19 16:38:42,196 - INFO - Image shape: (31, 512, 512)
2025-08-19 16:38:53,507 - INFO - Saved mask: /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test/masks/BNfarP1+17i_FN647_pSMADRR_DAPI_A8301_Cover1_1001_40_nuclei_mask.tif with 4 nuclei
2025-08-19 16:38:53,854 - INFO - Processing BNfarP1+17i_FN647_pSMADRR_DAPI_A8301_Cover1_1002_40_nuclei.tif
2025-08-19 16:38:53,903 - INFO - Image shape: (29, 512, 512)
2025-08-19 16:39:02,995 - INFO - Saved mask: /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test/masks/BNfarP1+17i_FN647_pSMADRR_DAPI_A8301_Cover1_1002_40_nuclei_mask.tif with 5 nuclei
2025-08-19 16:39:03,168 - INFO - Processing BNfarP1+17i_FN647_pSMADRR_DAPI_A8301_Cover1_1003_40_nuclei.tif
2025-08-19 16:39:03,219 - INFO - Image shape: (31, 512, 512)
2025-08-19 16:39:12,417 - INFO - Saved mask: /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test/masks/BNfarP1+17i_FN647_pSMADRR_DAPI_A8301_Cover1_1003_40_nuclei_mask.tif with 7 nuclei
2025-08-19 16:39:12,571 - INFO - Processing BNfarP1+17i_FN647_pSMADRR_DAPI_A8301_Cover2_1001_40_nuclei.tif
2025-08-19 16:39:12,617 - INFO - Image shape: (29, 512, 512)
2025-08-19 16:39:21,236 - INFO - Saved mask: /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test/masks/BNfarP1+17i_FN647_pSMADRR_DAPI_A8301_Cover2_1001_40_nuclei_mask.tif with 1 nuclei
2025-08-19 16:39:21,384 - INFO - Processing BNfarP1+17i_FN647_pSMADRR_DAPI_DMSO_Cover1_1004_40_nuclei.tif
2025-08-19 16:39:21,439 - INFO - Image shape: (34, 512, 512)
2025-08-19 16:39:34,354 - INFO - Saved mask: /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test/masks/BNfarP1+17i_FN647_pSMADRR_DAPI_DMSO_Cover1_1004_40_nuclei_mask.tif with 6 nuclei
2025-08-19 16:39:34,525 - INFO - Processing BNfarP1+17i_FN647_pSMADRR_DAPI_DMSO_Cover1_1005_40_nuclei.tif
2025-08-19 16:39:34,592 - INFO - Image shape: (39, 512, 512)
2025-08-19 16:39:47,444 - INFO - Saved mask: /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test/masks/BNfarP1+17i_FN647_pSMADRR_DAPI_DMSO_Cover1_1005_40_nuclei_mask.tif with 5 nuclei
2025-08-19 16:39:47,620 - INFO - Processing BNfarP1+17i_FN647_pSMADRR_DAPI_DMSO_Cover1_1006_40_nuclei.tif
2025-08-19 16:39:47,700 - INFO - Image shape: (37, 512, 512)
2025-08-19 16:40:00,468 - INFO - Saved mask: /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test/masks/BNfarP1+17i_FN647_pSMADRR_DAPI_DMSO_Cover1_1006_40_nuclei_mask.tif with 3 nuclei
2025-08-19 16:40:03,762 - ERROR - Pipeline failed: n_samples=1 while HDBSCAN requires more than one sample
Traceback (most recent call last):
  File "/Users/aleksandrdolskii/Desktop/GITHUB/UMA-tools/code/nuclei_layers_analysis.py", line 645, in main
    cluster(csv_out, clus, cfg["z_scale_factor"], summaries)
  File "/Users/aleksandrdolskii/Desktop/GITHUB/UMA-tools/code/nuclei_layers_analysis.py", line 429, in cluster
    ).fit(xz_coords)
  File "/Users/aleksandrdolskii/miniconda3/envs/uma_tools/lib/python3.10/site-packages/sklearn/base.py", line 1363, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "/Users/aleksandrdolskii/miniconda3/envs/uma_tools/lib/python3.10/site-packages/sklearn/cluster/_hdbscan/hdbscan.py", line 776, in fit
    raise ValueError("n_samples=1 while HDBSCAN requires more than one sample")
ValueError: n_samples=1 while HDBSCAN requires more than one sample
2025-08-19 16:45:59,688 - INFO - === 3D Nuclei Analysis Pipeline ===
2025-08-19 16:45:59,688 - INFO - Start: 2025-08-19 16:45:59
2025-08-19 16:45:59,694 - INFO - Execution mode: full
2025-08-19 16:45:59,936 - INFO - Loaded custom model: /Users/aleksandrdolskii/Desktop/Models for FIA/stardist-512-v3-2
2025-08-19 16:45:59,938 - INFO - Running Fiji processing in main process for /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test
2025-08-19 16:45:59,938 - INFO - Starting Fiji processing for /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test
2025-08-19 16:46:08,356 - INFO - Saved /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test/processed/BNfarP1+17i_FN647_pSMADRR_DAPI_A8301_Cover1_1004_60_nuclei.tif
2025-08-19 16:46:09,696 - INFO - Saved /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test/processed/BNfarP1+17i_FN647_pSMADRR_DAPI_A8301_Cover1_1005_60_nuclei.tif
2025-08-19 16:46:11,289 - INFO - Saved /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test/processed/BNfarP1+17i_FN647_pSMADRR_DAPI_A8301_Cover1_1006_60_nuclei.tif
2025-08-19 16:46:13,154 - INFO - Saved /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test/processed/BNfarP1+17i_FN647_pSMADRR_DAPI_DMSO_Cover1_1001_60_nuclei.tif
2025-08-19 16:46:14,663 - INFO - Saved /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test/processed/BNfarP1+17i_FN647_pSMADRR_DAPI_DMSO_Cover1_1002_60_nuclei.tif
2025-08-19 16:46:16,365 - INFO - Saved /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test/processed/BNfarP1+17i_FN647_pSMADRR_DAPI_DMSO_Cover1_1003_60_nuclei.tif
2025-08-19 16:46:18,037 - INFO - Saved /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test/processed/BNfarP1+17i_FN647_pSMADRR_DAPI_DMSO_Cover2_1001_60_nuclei.tif
2025-08-19 16:46:53,548 - INFO - === 3D Nuclei Analysis Pipeline ===
2025-08-19 16:46:53,548 - INFO - Start: 2025-08-19 16:46:53
2025-08-19 16:47:02,252 - INFO - Execution mode: stardist
2025-08-19 16:47:02,496 - INFO - Loaded custom model: /Users/aleksandrdolskii/Desktop/Models for FIA/stardist-512-v3-2
2025-08-19 16:47:02,496 - INFO - Starting segmentation with n_tiles: [2, 4, 4]
2025-08-19 16:47:02,496 - INFO - Starting segmentation with n_tiles: (2, 4, 4)
2025-08-19 16:47:02,496 - INFO - Processing BNfarP1+17i_FN647_pSMADRR_DAPI_A8301_Cover1_1004_60_nuclei.tif
2025-08-19 16:47:02,555 - INFO - Image shape: (27, 512, 512)
2025-08-19 16:47:15,021 - INFO - Saved mask: /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test/masks/BNfarP1+17i_FN647_pSMADRR_DAPI_A8301_Cover1_1004_60_nuclei_mask.tif with 8 nuclei
2025-08-19 16:47:15,545 - INFO - Processing BNfarP1+17i_FN647_pSMADRR_DAPI_A8301_Cover1_1005_60_nuclei.tif
2025-08-19 16:47:15,591 - INFO - Image shape: (24, 512, 512)
2025-08-19 16:47:24,565 - INFO - Saved mask: /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test/masks/BNfarP1+17i_FN647_pSMADRR_DAPI_A8301_Cover1_1005_60_nuclei_mask.tif with 2 nuclei
2025-08-19 16:47:24,718 - INFO - Processing BNfarP1+17i_FN647_pSMADRR_DAPI_A8301_Cover1_1006_60_nuclei.tif
2025-08-19 16:47:24,769 - INFO - Image shape: (28, 512, 512)
2025-08-19 16:47:33,580 - INFO - Saved mask: /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test/masks/BNfarP1+17i_FN647_pSMADRR_DAPI_A8301_Cover1_1006_60_nuclei_mask.tif with 6 nuclei
2025-08-19 16:47:33,727 - INFO - Processing BNfarP1+17i_FN647_pSMADRR_DAPI_DMSO_Cover1_1001_60_nuclei.tif
2025-08-19 16:47:33,815 - INFO - Image shape: (38, 512, 512)
2025-08-19 16:47:47,289 - INFO - Saved mask: /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test/masks/BNfarP1+17i_FN647_pSMADRR_DAPI_DMSO_Cover1_1001_60_nuclei_mask.tif with 10 nuclei
2025-08-19 16:47:47,453 - INFO - Processing BNfarP1+17i_FN647_pSMADRR_DAPI_DMSO_Cover1_1002_60_nuclei.tif
2025-08-19 16:47:47,511 - INFO - Image shape: (28, 512, 512)
2025-08-19 16:47:57,456 - INFO - Saved mask: /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test/masks/BNfarP1+17i_FN647_pSMADRR_DAPI_DMSO_Cover1_1002_60_nuclei_mask.tif with 19 nuclei
2025-08-19 16:47:57,615 - INFO - Processing BNfarP1+17i_FN647_pSMADRR_DAPI_DMSO_Cover1_1003_60_nuclei.tif
2025-08-19 16:47:57,673 - INFO - Image shape: (34, 512, 512)
2025-08-19 16:48:11,546 - INFO - Saved mask: /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test/masks/BNfarP1+17i_FN647_pSMADRR_DAPI_DMSO_Cover1_1003_60_nuclei_mask.tif with 11 nuclei
2025-08-19 16:48:11,696 - INFO - Processing BNfarP1+17i_FN647_pSMADRR_DAPI_DMSO_Cover2_1001_60_nuclei.tif
2025-08-19 16:48:11,761 - INFO - Image shape: (36, 512, 512)
2025-08-19 16:48:25,972 - INFO - Saved mask: /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test/masks/BNfarP1+17i_FN647_pSMADRR_DAPI_DMSO_Cover2_1001_60_nuclei_mask.tif with 15 nuclei
2025-08-19 16:48:27,421 - ERROR - Pipeline failed: min_samples (3) must be at most the number of samples in X (2)
Traceback (most recent call last):
  File "/Users/aleksandrdolskii/Desktop/GITHUB/UMA-tools/code/nuclei_layers_analysis.py", line 645, in main
    cluster(csv_out, clus, cfg["z_scale_factor"], summaries)
  File "/Users/aleksandrdolskii/Desktop/GITHUB/UMA-tools/code/nuclei_layers_analysis.py", line 429, in cluster
    ).fit(xz_coords)
  File "/Users/aleksandrdolskii/miniconda3/envs/uma_tools/lib/python3.10/site-packages/sklearn/base.py", line 1363, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "/Users/aleksandrdolskii/miniconda3/envs/uma_tools/lib/python3.10/site-packages/sklearn/cluster/_hdbscan/hdbscan.py", line 782, in fit
    raise ValueError(
ValueError: min_samples (3) must be at most the number of samples in X (2)
2025-08-19 17:21:58,659 - INFO - === 3D Nuclei Analysis Pipeline ===
2025-08-19 17:21:58,660 - INFO - Start: 2025-08-19 17:21:58
2025-08-19 17:21:58,665 - INFO - Execution mode: full
2025-08-19 17:21:58,809 - INFO - Loaded custom model: /Users/aleksandrdolskii/Desktop/Models for FIA/stardist-512-v3-2
2025-08-19 17:21:58,809 - INFO - Running Fiji processing in main process for /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test
2025-08-19 17:21:58,810 - INFO - Starting Fiji processing for /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test
2025-08-19 17:22:09,154 - INFO - Saved /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test/processed/BNfarP1+17i_FN647_pSMADRR_DAPI_A8301_Cover1_1004_60_nuclei.tif
2025-08-19 17:22:10,670 - INFO - Saved /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test/processed/BNfarP1+17i_FN647_pSMADRR_DAPI_A8301_Cover1_1005_60_nuclei.tif
2025-08-19 17:22:29,864 - INFO - === 3D Nuclei Analysis Pipeline ===
2025-08-19 17:22:29,864 - INFO - Start: 2025-08-19 17:22:29
2025-08-19 17:22:31,153 - INFO - Execution mode: stardist
2025-08-19 17:22:31,341 - INFO - Loaded custom model: /Users/aleksandrdolskii/Desktop/Models for FIA/stardist-512-v3-2
2025-08-19 17:22:31,341 - INFO - Starting segmentation with n_tiles: [2, 4, 4]
2025-08-19 17:22:31,341 - INFO - Starting segmentation with n_tiles: (2, 4, 4)
2025-08-19 17:22:31,342 - INFO - Processing BNfarP1+17i_FN647_pSMADRR_DAPI_A8301_Cover1_1004_60_nuclei.tif
2025-08-19 17:22:31,401 - INFO - Image shape: (27, 512, 512)
2025-08-19 17:22:44,060 - INFO - Saved mask: /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test/masks/BNfarP1+17i_FN647_pSMADRR_DAPI_A8301_Cover1_1004_60_nuclei_mask.tif with 8 nuclei
2025-08-19 17:22:45,122 - INFO - Processing BNfarP1+17i_FN647_pSMADRR_DAPI_A8301_Cover1_1005_60_nuclei.tif
2025-08-19 17:22:45,163 - INFO - Image shape: (24, 512, 512)
2025-08-19 17:22:54,413 - INFO - Saved mask: /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test/masks/BNfarP1+17i_FN647_pSMADRR_DAPI_A8301_Cover1_1005_60_nuclei_mask.tif with 2 nuclei
2025-08-19 17:22:54,953 - ERROR - Pipeline failed: min_samples (3) must be at most the number of samples in X (2)
Traceback (most recent call last):
  File "/Users/aleksandrdolskii/Desktop/GITHUB/UMA-tools/code/nuclei_layers_analysis.py", line 644, in main
    cluster(csv_out, clus, cfg["z_scale_factor"], summaries)
  File "/Users/aleksandrdolskii/Desktop/GITHUB/UMA-tools/code/nuclei_layers_analysis.py", line 403, in cluster
    ).fit(xz_coords)
      ^^^^^^^^^^^^^^
  File "/Users/aleksandrdolskii/miniconda3/envs/NL1/lib/python3.12/site-packages/sklearn/base.py", line 1365, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aleksandrdolskii/miniconda3/envs/NL1/lib/python3.12/site-packages/sklearn/cluster/_hdbscan/hdbscan.py", line 782, in fit
    raise ValueError(
ValueError: min_samples (3) must be at most the number of samples in X (2)
2025-08-19 17:24:58,062 - INFO - === 3D Nuclei Analysis Pipeline ===
2025-08-19 17:24:58,062 - INFO - Start: 2025-08-19 17:24:58
2025-08-19 17:25:23,916 - INFO - === 3D Nuclei Analysis Pipeline ===
2025-08-19 17:25:23,916 - INFO - Start: 2025-08-19 17:25:23
2025-08-19 17:25:30,722 - INFO - Execution mode: Fiji pre-processing
2025-08-19 17:25:30,725 - INFO - Running Fiji processing in main process for /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test
2025-08-19 17:25:30,726 - INFO - Starting Fiji processing for /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test
2025-08-19 17:25:36,272 - INFO - Saved /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test/processed/BNfarP1+17i_FN647_pSMADRR_DAPI_A8301_Cover1_1004_60_nuclei.tif
2025-08-19 17:25:37,724 - INFO - Saved /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test/processed/BNfarP1+17i_FN647_pSMADRR_DAPI_A8301_Cover1_1005_60_nuclei.tif
2025-08-19 17:25:50,367 - INFO - === 3D Nuclei Analysis Pipeline ===
2025-08-19 17:25:50,367 - INFO - Start: 2025-08-19 17:25:50
2025-08-19 17:25:55,975 - INFO - Execution mode: stardist
2025-08-19 17:25:56,112 - INFO - Loaded custom model: /Users/aleksandrdolskii/Desktop/Models for FIA/stardist-512-v3-2
2025-08-19 17:25:56,112 - INFO - Starting segmentation with n_tiles: [2, 4, 4]
2025-08-19 17:25:56,112 - INFO - Starting segmentation with n_tiles: (2, 4, 4)
2025-08-19 17:25:56,112 - INFO - Processing BNfarP1+17i_FN647_pSMADRR_DAPI_A8301_Cover1_1004_60_nuclei.tif
2025-08-19 17:25:56,157 - INFO - Image shape: (27, 512, 512)
2025-08-19 17:26:08,556 - INFO - Saved mask: /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test/masks/BNfarP1+17i_FN647_pSMADRR_DAPI_A8301_Cover1_1004_60_nuclei_mask.tif with 8 nuclei
2025-08-19 17:26:08,886 - INFO - Processing BNfarP1+17i_FN647_pSMADRR_DAPI_A8301_Cover1_1005_60_nuclei.tif
2025-08-19 17:26:08,944 - INFO - Image shape: (24, 512, 512)
2025-08-19 17:26:18,120 - INFO - Saved mask: /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test/masks/BNfarP1+17i_FN647_pSMADRR_DAPI_A8301_Cover1_1005_60_nuclei_mask.tif with 2 nuclei
2025-08-19 17:26:18,241 - INFO - === Processing Complete ===
2025-08-19 17:26:18,242 - INFO - End: 2025-08-19 17:26:18
2025-08-19 17:26:44,247 - INFO - === 3D Nuclei Analysis Pipeline ===
2025-08-19 17:26:44,247 - INFO - Start: 2025-08-19 17:26:44
2025-08-19 17:26:46,037 - INFO - Execution mode: Fiji post-processing
2025-08-19 17:27:11,494 - INFO - === 3D Nuclei Analysis Pipeline ===
2025-08-19 17:27:11,494 - INFO - Start: 2025-08-19 17:27:11
2025-08-19 17:27:14,291 - INFO - Execution mode: post
2025-08-19 17:27:14,302 - ERROR - Pipeline failed: min_samples (3) must be at most the number of samples in X (2)
Traceback (most recent call last):
  File "/Users/aleksandrdolskii/Desktop/GITHUB/UMA-tools/code/nuclei_layers_analysis.py", line 644, in main
    cluster(csv_out, clus, cfg["z_scale_factor"], summaries)
  File "/Users/aleksandrdolskii/Desktop/GITHUB/UMA-tools/code/nuclei_layers_analysis.py", line 403, in cluster
    ).fit(xz_coords)
      ^^^^^^^^^^^^^^
  File "/Users/aleksandrdolskii/miniconda3/envs/NL1/lib/python3.12/site-packages/sklearn/base.py", line 1365, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aleksandrdolskii/miniconda3/envs/NL1/lib/python3.12/site-packages/sklearn/cluster/_hdbscan/hdbscan.py", line 782, in fit
    raise ValueError(
ValueError: min_samples (3) must be at most the number of samples in X (2)
2025-08-19 17:31:37,778 - INFO - === 3D Nuclei Analysis Pipeline ===
2025-08-19 17:31:37,778 - INFO - Start: 2025-08-19 17:31:37
2025-08-19 17:31:39,298 - INFO - Execution mode: post
2025-08-19 17:31:39,309 - ERROR - Pipeline failed: min_samples (3) must be at most the number of samples in X (2)
Traceback (most recent call last):
  File "/Users/aleksandrdolskii/Desktop/GITHUB/UMA-tools/code/nuclei_layers_analysis.py", line 644, in main
    cluster(csv_out, clus, cfg["z_scale_factor"], summaries)
  File "/Users/aleksandrdolskii/Desktop/GITHUB/UMA-tools/code/nuclei_layers_analysis.py", line 403, in cluster
    ).fit(xz_coords)
      ^^^^^^^^^^^^^^
  File "/Users/aleksandrdolskii/miniconda3/envs/NL1/lib/python3.12/site-packages/sklearn/base.py", line 1365, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aleksandrdolskii/miniconda3/envs/NL1/lib/python3.12/site-packages/sklearn/cluster/_hdbscan/hdbscan.py", line 782, in fit
    raise ValueError(
ValueError: min_samples (3) must be at most the number of samples in X (2)
2025-08-19 17:32:11,181 - INFO - === 3D Nuclei Analysis Pipeline ===
2025-08-19 17:32:11,181 - INFO - Start: 2025-08-19 17:32:11
2025-08-19 17:32:13,102 - INFO - Execution mode: Fiji post-processing
2025-08-20 08:42:20,828 - INFO - === 3D Nuclei Analysis Pipeline ===
2025-08-20 08:42:20,829 - INFO - Start: 2025-08-20 08:42:20
2025-08-20 08:42:20,835 - INFO - Execution mode: full
2025-08-20 08:42:21,060 - INFO - Loaded custom model: /Users/aleksandrdolskii/Desktop/Models for FIA/stardist-512-v3-2
2025-08-20 08:42:21,061 - INFO - Running Fiji processing in main process for /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test
2025-08-20 08:42:21,061 - INFO - Starting Fiji processing for /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test
2025-08-20 08:42:29,484 - INFO - Saved /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test/processed/BNfarP1+17i_FN647_pSMADRR_DAPI_A8301_Cover1_1004_60_nuclei.tif
2025-08-20 08:42:30,862 - INFO - Saved /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test/processed/BNfarP1+17i_FN647_pSMADRR_DAPI_A8301_Cover1_1005_60_nuclei.tif
2025-08-20 08:43:40,035 - INFO - === 3D Nuclei Analysis Pipeline ===
2025-08-20 08:43:40,035 - INFO - Start: 2025-08-20 08:43:40
2025-08-20 08:43:42,597 - INFO - Execution mode: Fiji pre-processing
2025-08-20 08:43:42,600 - INFO - Running Fiji processing in main process for /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test
2025-08-20 08:43:42,600 - INFO - Starting Fiji processing for /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test
2025-08-20 08:43:48,206 - INFO - Saved /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test/processed/BNfarP1+17i_FN647_pSMADRR_DAPI_A8301_Cover1_1004_60_nuclei.tif
2025-08-20 08:43:49,605 - INFO - Saved /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test/processed/BNfarP1+17i_FN647_pSMADRR_DAPI_A8301_Cover1_1005_60_nuclei.tif
2025-08-20 08:43:59,063 - INFO - === 3D Nuclei Analysis Pipeline ===
2025-08-20 08:43:59,063 - INFO - Start: 2025-08-20 08:43:59
2025-08-20 08:44:00,775 - INFO - Execution mode: stardist
2025-08-20 08:44:00,911 - INFO - Loaded custom model: /Users/aleksandrdolskii/Desktop/Models for FIA/stardist-512-v3-2
2025-08-20 08:44:00,911 - INFO - Starting segmentation with n_tiles: [2, 4, 4]
2025-08-20 08:44:00,911 - INFO - Starting segmentation with n_tiles: (2, 4, 4)
2025-08-20 08:44:00,911 - INFO - Processing BNfarP1+17i_FN647_pSMADRR_DAPI_A8301_Cover1_1004_60_nuclei.tif
2025-08-20 08:44:00,965 - INFO - Image shape: (27, 512, 512)
2025-08-20 08:44:13,403 - INFO - Saved mask: /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test/masks/BNfarP1+17i_FN647_pSMADRR_DAPI_A8301_Cover1_1004_60_nuclei_mask.tif with 8 nuclei
2025-08-20 08:44:13,962 - INFO - Processing BNfarP1+17i_FN647_pSMADRR_DAPI_A8301_Cover1_1005_60_nuclei.tif
2025-08-20 08:44:14,005 - INFO - Image shape: (24, 512, 512)
2025-08-20 08:44:22,977 - INFO - Saved mask: /Users/aleksandrdolskii/Desktop/ImageJ projects/Syrvival assay/Quality control/Nuclei layers test/masks/BNfarP1+17i_FN647_pSMADRR_DAPI_A8301_Cover1_1005_60_nuclei_mask.tif with 2 nuclei
2025-08-20 08:44:23,097 - INFO - === Processing Complete ===
2025-08-20 08:44:23,097 - INFO - End: 2025-08-20 08:44:23
2025-08-20 08:44:34,338 - INFO - === 3D Nuclei Analysis Pipeline ===
2025-08-20 08:44:34,338 - INFO - Start: 2025-08-20 08:44:34
2025-08-20 08:44:35,706 - INFO - Execution mode: Fiji post-processing
